<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8">
  <title>NYC Destruction Probability Calculator</title>

  <style>
    body {
      font-family: system-ui, -apple-system, BlinkMacSystemFont, sans-serif;
      line-height: 1.5;
      max-width: 720px;
      margin: 40px auto;
      padding: 0 20px;
    }

    input {
      width: 100px;
      margin-left: 8px;
    }

    button {
      margin-top: 15px;
      padding: 6px 12px;
      font-size: 1em;
    }

    .box {
      border: 1px solid #ccc;
      padding: 15px;
      margin-top: 20px;
      background: #fafafa;
    }

    .math {
      font-family: monospace;
      background: #f0f0f0;
      padding: 4px 6px;
      border-radius: 4px;
      display: inline-block;
    }

    label {
      display: block;
      margin-top: 10px;
    }
  </style>
</head>

<body>

<h1>NYC Destruction Probability Calculator</h1>

<p>
We model fictional destructions of New York City using a <strong>Poisson process</strong>.
This assumes destruction events occur independently at a constant average rate.
</p>

<p>
Based on approximately <strong>300 movies</strong> depicting NYC destruction between
<strong>1933–2025 (92 years)</strong>, we estimate:
</p>

<ul>
  <li>Average rate per year: <strong>300 / 92 ≈ 3.26</strong></li>
  <li>Average rate per day: <strong>3.26 / 365 ≈ 0.00893</strong></li>
</ul>

<hr>

<h2>Calculator</h2>

<label>
  Number of days (<em>t</em>):<br>
  <input type="number" id="days" value="7" min="0" step="1">
</label>

<br><br>

<label>
  Number of destruction events (<em>k</em>):<br>
  <input type="number" id="k" value="0" min="0" step="1">
</label>

<br><br>

<button onclick="compute()">Compute probability</button>

<hr>

<div id="output"></div>

<script>
function factorial(n) {
  if (n === 0) return 1;
  let result = 1;
  for (let i = 1; i <= n; i++) result *= i;
  return result;
}

function compute() {
  const days = Number(document.getElementById("days").value);
  const k = Number(document.getElementById("k").value);

  const ratePerYear = 300 / 92;
  const ratePerDay = ratePerYear / 365;

  const lambda = ratePerDay * days;

  const pExact =
    Math.exp(-lambda) * Math.pow(lambda, k) / factorial(k);

  let html = `
    <h3>Explanation</h3>

    <p>
    We model the number of NYC destructions as a Poisson random variable.
    </p>

    <p>
    The Poisson formula gives the probability of observing exactly
    <strong>k events</strong> in a time interval of length <strong>t</strong>:
    </p>

    <p style="text-align:center;">
      <strong>P(k events in interval t) = (λ<sup>k</sup> e<sup>−λ</sup>) / k!</strong>
    </p>

    <p>
    where <strong>λ = r × t</strong>, with <em>r</em> the average rate of events per day.
    </p>

    <hr>

    <p>
    Using:
    </p>

    <ul>
      <li>Rate per day: <strong>${ratePerDay.toFixed(5)}</strong></li>
      <li>Days (t): <strong>${days}</strong></li>
      <li>λ = r × t = <strong>${lambda.toFixed(4)}</strong></li>
    </ul>

    <p>
    The probability of observing <strong>exactly ${k}</strong> destruction event(s) is:
    </p>

    <p style="font-size:1.2em;">
      <strong>${(pExact * 100).toFixed(2)}%</strong>
    </p>
  `;

  if (k === 0) {
    const pAtLeastOne = 1 - Math.exp(-lambda);
    html += `
      <hr>
      <p>
      Since <strong>k = 0</strong>, this also lets us compute the probability that
      NYC is destroyed <strong>at least once</strong> during this time period:
      </p>

      <p style="text-align:center;">
        <strong>1 − P(0) = 1 − e<sup>−λ</sup></strong>
      </p>

      <p style="font-size:1.2em;">
        <strong>${(pAtLeastOne * 100).toFixed(2)}%</strong>
      </p>
    `;
  }

  document.getElementById("output").innerHTML = html;
}
</script>


<p><a href="index.html">← Back to collection</a></p>

</body>
</html>
